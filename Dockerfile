# base image - https://github.com/devfile/developer-images
FROM quay.io/devfile/base-developer-image

# Java
ENV JAVA_VERSION=8.0.362 \
    JAVA_HOME=/home/user/.sdkman/candidates/java/current

# maven
ENV MAVEN_VERSION=3.3.3 \
    MAVEN_HOME=/home/user/.sdkman/candidates/maven/current

# path
ENV PATH=${JAVA_HOME}/bin:${MAVEN_HOME}/bin:$PATH

# install packages
RUN curl -fsSL "https://get.sdkman.io" | bash ; \
    source "/home/user/.sdkman/bin/sdkman-init.sh" ; \
    sed -i "s/sdkman_auto_answer=false/sdkman_auto_answer=true/g" /home/user/.sdkman/etc/config ; \
    sdk update ; \
    sdk install java ${JAVA_VERSION}-tem ; \
    sdk install maven ${MAVEN_VERSION} ; \
    sdk flush archives ; \
    sdk flush temp ;

# maven default configuration for maven
COPY files/settings.xml /home/user/.sdkman/candidates/maven/current/conf/settings.xml


# exec with root user
USER 0

# install internal certificates
COPY files/*.crt /etc/ssl/certs/
RUN echo 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZZVENDQkVtZ0F3SUJBZ0lFWFUzYkl6QU5CZ2txaGtpRzl3MEJBUXNGQURDQmlURUxNQWtHQTFVRUJoTUMKUWxJeEN6QUpCZ05WQkFnTUFrUkdNUkV3RHdZRFZRUUhEQWhDY21GemFXeHBZVEVoTUI4R0ExVUVDZ3dZUWxKQwpJRUpoYm1OdklHUmxJRUp5WVhOcGJHbGhJRk5CTVNBd0hnWURWUVFMREJkRVNWUkZReTlUVlZCU1R5OUhSVlJKClV5OU9WVU5QVFRFVk1CTUdBMVVFQXd3TUtpNWljbUl1WTI5dExtSnlNQ0FYRFRFNU1EZ3dPVEl3TkRReE9Wb1kKRHpJeE1Ua3dPREE1TWpBME5ERTVXakNCaVRFTE1Ba0dBMVVFQmhNQ1FsSXhDekFKQmdOVkJBZ01Ba1JHTVJFdwpEd1lEVlFRSERBaENjbUZ6YVd4cFlURWhNQjhHQTFVRUNnd1lRbEpDSUVKaGJtTnZJR1JsSUVKeVlYTnBiR2xoCklGTkJNU0F3SGdZRFZRUUxEQmRFU1ZSRlF5OVRWVkJTVHk5SFJWUkpVeTlPVlVOUFRURVZNQk1HQTFVRUF3d00KS2k1aWNtSXVZMjl0TG1KeU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBbzhIOQoyUHNJS0poVFRGVG4xU0hXbXljS1lFeWFmQTBNTjZhdkZhYTlQR2hnQUo4aFZodExwejRGR04vY2U4U24wTGE5CkxJYVMzbGJ6aHlPT3JaeFBsdUxWa3U4WlNvVlFJa0I5USt4UEZybnorZVpoakFEY2JRQ2gyQWF0V0xSWlUydXEKOHRzY1RBditYZFNVUThBelhrL2FId1VSajlGNFNhSkdwVE02Sjh0aHJLUEF6d1Q0Z1l2Z3FTa0pXUWFSWUZrOApzMmQweFlNVm1kUUlOeEJMK2RWRUJjdXlubkxtay83UXNNeFVuSUc3bGd2UjQ4NHJpb1BJZFd1b2FpbjRMbW45Cm9lSVo1VnFIOHhqZFgrd0g4M2ZJenJyM3YzWmMxRXhtUmxwK1dhdmVDMnJrOWVzT1oxV1RmSTRpSmkzN0NYYXQKcEk5aGpWbWpxdmtrVnZUbk5RSURBUUFCbzRJQnl6Q0NBY2N3Z2dGNEJnTlZIUkVFZ2dGdk1JSUJhNElTS2k1aQpZVzVyYUhWdFlXNHVZMjl0TG1KeWdnb3FMbUp5WWk1aUxtSnlnZ3dxTG1KeVlpNWpiMjB1WW5LQ0V5b3VZbkppClpHbG5hWFJoYkM1amIyMHVZbktDRlNvdVluSmlhVzV6ZEdsMGRYUnZMbU52YlM1aWNvSVFLaTVrZEhadFluSmkKTG1OdmJTNWljb0lXS2k1bWFXNWhibU5sYVhKaFluSmlMbU52YlM1aWNvSVNLaTVvZFcxaGJtSmhibXN1WTI5dApMbUp5Z2hVcUxtbHVjM1JwZEhWMGIySnlZaTV2Y21jdVluS0NEaXBpY21KbGVIUXVZMjl0TG1KeWdoQmlZVzVyCmFIVnRZVzR1WTI5dExtSnlnZ2hpY21JdVlpNWljb0lLWW5KaUxtTnZiUzVpY29JUlluSmlaR2xuYVhSaGJDNWoKYjIwdVluS0NEV0p5WW1WNGRDNWpiMjB1WW5LQ0UySnlZbWx1YzNScGRIVjBieTVqYjIwdVluS0NEbVIwZG0xaQpjbUl1WTI5dExtSnlnaFJtYVc1aGJtTmxhWEpoWW5KaUxtTnZiUzVpY29JUWFIVnRZVzVpWVc1ckxtTnZiUzVpCmNvSVRhVzV6ZEdsMGRYUnZZbkppTG05eVp5NWljakFkQmdOVkhRNEVGZ1FVYWliL1FydUV5WUlJU2hMS1d4N0wKd1BGRmt1b3dIUVlEVlIwbEJCWXdGQVlJS3dZQkJRVUhBd0VHQ0NzR0FRVUZCd01DTUFzR0ExVWREd1FFQXdJRgpvREFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBZHBYNmNPdm8yRHllL0N0ZUh2SThZTS9sYlJud0ZZNGZHWDNrCi90Q2xFVzNQbzNQeXBpUmIzVFA3T090VlNCVWcrd05UY2VsM0g1TWhKYTNiZjJhampNR05XRXZIcEJjU2k4OXAKeVY2aXR5bk5iS016QlUrNGZZR3F0aVNCR0hxLy9RaGxvKy80ekM3TXlLZHpzdjgyQmtSWHFoMUs4WVBEVnlCNgp1dHIrNjAvYlBYWFhFL0hyNHFJbXVrdWo3UkVEdGRFOWVvck5uYis3cUgyMkNyZDVFRXdSU0o1M3d1YmxwbG5WCkdKNWVHT01VNVloWjB5alJDYnY2VTVLdTJVUFc5RGs2MnZxTGZreUp3SjhYajVWMnpxaVd5L1luWFVvay9MTW8KSjdYa244NmZaRG1sYWl1N3gyY0lmZGNRMDFsR0xaZzFqWXhyckx4bXQ3NUVhT3V5V1E9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==' > /etc/ssl/certs/brb.com.br.crt ; \
    echo 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVLVENDQXhHZ0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRVUZBREJ6TVJVd0V3WURWUVFLREF4TlkwRm0KWldVc0lFbHVZeTR4RFRBTEJnTlZCQXNNQkU1VFFsVXhGREFTQmdOVkJBY01DMU5oYm5SaElFTnNZWEpoTVFzdwpDUVlEVlFRSURBSkRRVEVMTUFrR0ExVUVCaE1DVlZNeEd6QVpCZ05WQkFNTUVrMWpRV1psWlNCWFpXSWdSMkYwClpYZGhlVEFlRncweE5EQTBNall3TlRBeE16TmFGdzB5TkRBME1qWXdOVEF4TXpOYU1ITXhGVEFUQmdOVkJBb00KREUxalFXWmxaU3dnU1c1akxqRU5NQXNHQTFVRUN3d0VUbE5DVlRFVU1CSUdBMVVFQnd3TFUyRnVkR0VnUTJ4aApjbUV4Q3pBSkJnTlZCQWdNQWtOQk1Rc3dDUVlEVlFRR0V3SlZVekViTUJrR0ExVUVBd3dTVFdOQlptVmxJRmRsCllpQkhZWFJsZDJGNU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBaWljbGlYa2EKUU5KNGZXNkdjbHBSNkdPVTBiV1VVWFAzVXB2ZkdkTXpUS0pBYnpEckJPR0xSMXhOclZQd2VFOS80QVBWOXZZaApIemI3bHhPZTFyU3NrUWFJVGtCbGh3WmxEaXU2dFpyTWxTWHdhSU9GdzIrYkl4VGFqNXJ4eDZjN2wxeG80eEZSCmtGTVNvL2Z3bUMzZzAvSU5OdnprK3dRWDFlUUkrTzcrUlhINFUrYkxKWEJBNUpzUnQ5Ymk1N1FnTWZVS0FlWGEKcGR4RWU5YmVNRENGdExEQ3dKeFhtTXBsMzNLK1crSmVHajJnWDd1TGhRWmNxUTJmSGdZOWs1bXg5LzFSWWlDRgpMRjlJS1d5UTJJZ0VpV2xwei9SbEFoUUFHaCt2ZkRyWi96RmlRU1hWZytVdXBCdzVFUVVnK0JGcjcrVzZSS1hBCmFvaDllUXZJdm42VXF3SURBUUFCbzRISE1JSEVNSUdtQmdsZ2hrZ0JodmhDQVEwRWdaZ01nWlZVYUdseklHbHoKSUhSb1pTQmtaV1poZFd4MElFMWpRV1psWlNCWFpXSWdSMkYwWlhkaGVTQnliMjkwSUVOQkxpQkpkQ0IzYVd4cwpJR0psSUdSbGJHbDJaWEpsWkNCM2FYUm9JR1ZoWTJnZ2QyVmlJR2RoZEdWM1lYa2dhVzV6ZEdGc2JHRjBhVzl1CkxpQlhaU0J5WldOdmJXMWxibVFnZEc4Z1oyVnVaWEpoZEdVZ1lXNWtJSFZ6WlNCNWIzVnlJRzkzYmlCRFFUQU0KQmdOVkhSTUVCVEFEQVFIL01Bc0dBMVVkRHdRRUF3SUJCakFOQmdrcWhraUc5dzBCQVFVRkFBT0NBUUVBaWFwYQp5Rm9KUEZ6Q3V6R1F2aU1QZVNZZXRuN0cyQWFiTHlYRnQwZjVIc2JMQlRhWTEwSGFySlF3bHZjMVJybTJId0YzCnJ4dXBvSW5Fd1dLUXlxb3NTS3FzZmVnalRDZk1NQytId3I4RWVyaml1ejExU3YxSFhvQUpBYjJvQzFGYVpkdzIKaHZLWHp3NFRmTTFWQ2NiRmtTR2psbXp3NHJ2clUwcTQ0SEszNnRrckN4azhibjkwM2dNc0ltWEpxOE5xeE9ZTQphRWJQVTN6NmRYSE0vUUdBRkpaWFU0YlpZQnprMmdYb0lFa1R5ZGdnZVFCQ2dqeXNSeFBockZId041ME1jQ29GCmloRmNIUGpEUGV2aXcyOVg1enc5T0thZW9Wb3FJN0p4UEN4aFFDMUJMZ0MwQ3U4WEU5dFIrd055M3lDYTJDdGgKQVloTVJCTzhDclhRZ3VDeVh3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=' > /etc/ssl/certs/mcafee_proxy.crt ; \
    update-ca-trust ; \
    \
    chown 10001.0 $HOME/.gitconfig ;

# exec with normal user
USER 10001

